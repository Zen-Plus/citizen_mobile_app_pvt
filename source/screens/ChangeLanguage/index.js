import React, {useState} from 'react';
import {
  View,
  Text,
  StyleSheet,
  TouchableOpacity,
  FlatList,
  SafeAreaView,
  Image,
} from 'react-native';
import {Context} from '../../providers/localization';
import {colors, scaling, fonts} from '../../library';
import {LanguagesSymbol} from '../../library/svg';
import {connect} from 'react-redux';
import Header from '../../components/header';
import _ from 'lodash';
import LinearGradient from 'react-native-linear-gradient';
import {language, checkMark} from '../../../assets';
import CustomButton from '../../components/CustomButton';

const {normalize, widthScale, heightScale, moderateScale} = scaling;

const ChangeLanguage = props => {
  const {getStrings, setLanguageTag, languageTag} = React.useContext(Context);
  const {changeLanguage} = getStrings();

  const [selectedLanguage, setSelectedLanguage] = useState(languageTag);

  const data = [
    {
      id: 21,
      name: 'gu',
      displayName: 'ગુજરાતી',
      iconPath:
        'M13.363 16.285c.588 0 1.08-.119 1.472-.356.393-.237.709-.54.946-.91a3.74 3.74 0 00.504-1.21c.099-.438.148-.861.148-1.27 0-.444-.063-.883-.189-1.319a3.732 3.732 0 00-.562-1.166 2.916 2.916 0 00-.932-.828c-.372-.21-.808-.315-1.306-.315-.342 0-.662.059-.959.176-.297.117-.56.273-.792.468-.231.195-.43.421-.594.68a3.19 3.19 0 00-.374.81l1.35.963c.073-.192.157-.385.253-.58.096-.196.204-.371.324-.527a1.82 1.82 0 01.383-.378.712.712 0 01.418-.144.84.84 0 01.55.193c.156.13.286.297.391.504.105.207.183.44.234.698.051.258.077.516.077.774 0 .235-.026.485-.077.752-.05.267-.13.513-.238.739-.108.225-.246.41-.415.558a.897.897 0 01-.612.22.997.997 0 01-.535-.166 2.495 2.495 0 01-.505-.423 3.676 3.676 0 01-.432-.568 5.745 5.745 0 01-.328-.598l-1.252 1.017c.114.282.273.555.477.82.204.264.438.5.702.706.265.207.556.372.874.495.318.123.651.185 1 .185zm5.772 2.782V9.001h-1.73v10.066h1.73zm-1.17 4.466c.401 0 .794-.051 1.179-.153a3.152 3.152 0 001.021-.468c.298-.21.536-.476.716-.797.18-.321.27-.698.27-1.13 0-.312-.061-.608-.184-.887a2.125 2.125 0 00-.522-.725 2.518 2.518 0 00-.824-.486 3.123 3.123 0 00-1.09-.18 2.754 2.754 0 00-1.184.279 3.003 3.003 0 00-.603.4c-.195.166-.37.371-.527.617l.955.847c.09-.132.192-.252.306-.36.114-.108.231-.201.351-.28.12-.078.24-.138.36-.18.12-.042.231-.063.333-.063a.828.828 0 01.667.32c.078.1.136.212.175.338a1.3 1.3 0 01.059.396c0 .216-.051.392-.153.527-.102.135-.229.24-.379.315-.15.075-.309.127-.477.157a2.59 2.59 0 01-.45.045c-.366 0-.73-.073-1.09-.22a5.796 5.796 0 01-1.026-.545 7.18 7.18 0 01-.882-.689 8.514 8.514 0 01-.648-.653l-.99.982c.701.876 1.453 1.527 2.255 1.954.8.426 1.595.639 2.381.639z',
    },
    {
      id: 24,
      name: 'en',
      displayName: 'English',
      iconPath:
        'M13.52 21l.675-2.415h3.525L18.38 21h2.4l-3.195-10.515H14.39L11.21 21h2.31zm3.675-4.305H14.72l.435-1.53c.375-1.335.6-2.19.78-3.09h.06c.18.93.39 1.695.795 3.15l.405 1.47z',
    },
    {
      id: 22,
      name: 'or',
      displayName: 'ନୀୟ',
      iconPath:
        'M13.026 21.091a1.6 1.6 0 00.572-.098 1.4 1.4 0 00.437-.26c.12-.109.214-.237.279-.386.065-.149.097-.307.097-.474a.982.982 0 00-.083-.395 1.367 1.367 0 00-.233-.358 1.505 1.505 0 00-.348-.289 1.756 1.756 0 00-.433-.185c.05-.348.174-.674.372-.981.198-.307.457-.577.776-.81.32-.231.691-.42 1.116-.566a5.26 5.26 0 011.39-.265v4.974h1.599v-6.322h-1.246c-.434 0-.854.036-1.26.107a7.863 7.863 0 00-1.148.288c-.36.12-.694.266-1.004.437-.31.17-.585.352-.827.544a2.622 2.622 0 01-.372-1.385c0-.397.091-.767.274-1.111.183-.344.437-.643.763-.897.325-.255.71-.453 1.152-.595a4.688 4.688 0 011.446-.214c.52 0 1.002.071 1.446.214.443.142.827.34 1.152.595.326.254.58.553.763.897.183.344.274.714.274 1.11 0 .372-.08.735-.242 1.088a3.29 3.29 0 01-.688.976l.93 1.135c.508-.49.902-1.01 1.18-1.558.28-.548.419-1.095.419-1.64 0-.583-.132-1.127-.395-1.632a4.149 4.149 0 00-1.097-1.32 5.314 5.314 0 00-1.66-.883 6.51 6.51 0 00-2.082-.321c-.75 0-1.444.107-2.082.32a5.357 5.357 0 00-1.66.884 4.136 4.136 0 00-1.097 1.32 3.482 3.482 0 00-.395 1.632c0 .464.084.912.251 1.343.167.43.406.832.716 1.204a4.016 4.016 0 00-.577 2.054c0 .298.042.56.126.786.084.226.195.415.335.567.14.152.3.268.483.349.183.08.377.12.581.12z',
    },
    {
      id: 23,
      name: 'as',
      displayName: 'অসমীয়া',
      iconPath:
        'M20.269 20.351l1.17-1.198-.644-.381v-6.027h1.316v-1.434h-13v1.434h9.882v3c0 .724.052 1.71.157 2.04l-.039.026-1.118-.658c.105-.355.157-.737.157-1.158 0-1.618-1.144-2.829-2.789-2.829-1.329 0-2.29.934-2.29 2.053 0 .75.408 1.46 1.158 1.697l1.185-.908c-.342-.131-.5-.355-.5-.631 0-.316.223-.553.592-.553.513 0 .868.448.868 1.158 0 1.04-.605 1.763-1.737 1.763-1.737 0-2.842-1.802-3.368-4.237l-1.645.79c.763 2.947 2.369 5.092 5.026 5.092 1.04 0 1.895-.316 2.487-.868l3.132 1.828z',
    },
    {
      id: 25,
      name: 'hi',
      displayName: 'हिन्दी',
      iconPath:
        'M20.511 21.451v-8.43h1.575v-1.635h-4.86v1.635h1.17v3.105c-.285.15-.675.255-1.2.255-.375 0-.795-.09-1.2-.3a.314.314 0 01-.09-.06h-.015a1.733 1.733 0 00-.51-.18v-.06c.705-.345 1.095-1.08 1.095-1.935 0-1.53-1.17-2.535-2.925-2.535-1.245 0-2.19.57-2.67 1.26l1.32 1.245c.285-.465.69-.75 1.29-.75.645 0 1.05.405 1.05.99 0 .675-.375 1.155-1.29 1.155h-.525v1.755h.81c.96 0 1.425.39 1.425 1.035 0 .66-.465 1.14-1.26 1.14-.975 0-1.62-.645-1.935-1.2l-1.455 1.335c.375.555 1.395 1.62 3.36 1.62 2.04 0 3.315-1.245 3.315-2.94v-.09c.225.09.465.15.735.15.255 0 .48-.045.675-.105v3.54h2.115z',
    },
    {
      id: 26,
      name: 'te',
      displayName: 'తెలుగు',
      iconPath:
        'M15.861 22.076c3.345 0 5.55-1.83 5.55-4.125 0-.495-.135-.945-.375-1.32.06-.255.075-.495.075-.63 0-.675-.225-1.245-.645-1.68.435-.405.645-.96.645-1.59 0-1.245-.84-2.22-2.535-2.22h-7.59v1.65h7.575c.525 0 .75.225.75.57s-.225.57-.75.57h-2.13v1.65h1.62c.795 0 1.155.195 1.245.51a3.28 3.28 0 00-.54-.045c-1.485 0-2.52.93-2.52 2.325 0 1.305 1.005 2.01 1.965 2.01.09 0 .165 0 .255-.015l.03.06c-.66.39-1.65.585-2.625.585-.975 0-1.965-.195-2.625-.585l.03-.06c.075.015.165.015.255.015.96 0 1.965-.705 1.965-2.01 0-1.395-1.035-2.325-2.52-2.325-1.5 0-2.655 1.095-2.655 2.535 0 2.295 2.205 4.125 5.55 4.125zm-2.97-3.465c-.495 0-.735-.345-.735-.75s.3-.765.81-.765c.42 0 .705.27.705.735 0 .42-.3.78-.78.78zm5.94 0c-.48 0-.78-.36-.78-.78 0-.465.285-.735.705-.735.51 0 .81.36.81.765s-.24.75-.735.75z',
    },
    {
      id: 27,
      name: 'ta',
      displayName: 'தமிழ்',
      iconPath:
        'M12.671 21.329v-.586c0-.161.02-.311.062-.45a.857.857 0 01.216-.363c.103-.103.242-.183.418-.242.176-.058.398-.088.666-.088h1.188c.86 0 1.599-.083 2.22-.249.62-.166 1.13-.411 1.53-.736.4-.324.696-.727.886-1.208.19-.481.286-1.034.286-1.66 0-.37-.038-.689-.114-.955a2.185 2.185 0 00-.304-.67 1.575 1.575 0 00-.446-.432 2.312 2.312 0 00-.539-.25 2.75 2.75 0 00-.578-.113 6.636 6.636 0 00-.568-.025h-.198v-1.531h2.146v-1.26h-6.3v2.79a1.846 1.846 0 00-1.267.528 1.96 1.96 0 00-.428.63 2.1 2.1 0 00-.165.857c0 .493.088.908.264 1.245.175.337.404.609.684.816.281.208.595.358.942.45.346.094.69.14 1.032.14.347 0 .703-.05 1.07-.15.366-.1.7-.263 1-.487.3-.225.545-.52.736-.886.19-.367.285-.813.285-1.34v-.601h.176c.107 0 .22.022.34.066.12.044.23.116.33.216.1.1.182.232.245.395.064.164.096.363.096.597 0 .498-.08.912-.238 1.242-.159.33-.375.592-.649.787a2.59 2.59 0 01-.97.414c-.374.08-.775.12-1.205.12h-1.529c-.547 0-1.005.054-1.374.162-.369.107-.664.257-.886.45a1.626 1.626 0 00-.476.692 2.645 2.645 0 00-.143.887v.798h1.56zm3.15-8.028h-1.173v-1.53h1.171v1.53zm-1.503 3.406a1.63 1.63 0 01-.476-.073 1.367 1.367 0 01-.443-.23 1.224 1.224 0 01-.33-.41 1.333 1.333 0 01-.128-.605c0-.112.02-.222.062-.33a.806.806 0 01.19-.285.929.929 0 01.316-.198c.124-.049.27-.073.435-.073h1.877v.6c0 .186-.03.374-.091.564-.061.19-.154.363-.278.517a1.46 1.46 0 01-.47.377 1.42 1.42 0 01-.662.146z',
    },
    {
      id: 28,
      name: 'ml',
      displayName: 'മലയാളം',
      iconPath:
        'M21.151 21.495v-5.516a4.734 4.734 0 00-1.295-3.263 4.613 4.613 0 00-1.492-1.025 4.81 4.81 0 00-1.94-.38c-.86 0-1.62.127-2.281.38-.661.254-1.216.595-1.665 1.025-.45.43-.79.928-1.02 1.492a4.635 4.635 0 00-.347 1.771v5.516h10.04zm-1.82-1.637h-4.072c.469-.276.86-.574 1.175-.895a4.6 4.6 0 00.75-.986c.187-.337.318-.68.395-1.026.077-.346.116-.69.116-1.03 0-.25-.028-.51-.082-.78a4.675 4.675 0 00-.24-.798 4.67 4.67 0 00-.405-.775 4.284 4.284 0 00-.573-.707c.533.057.985.19 1.357.4.373.208.676.476.91.803.234.327.404.704.51 1.13.106.428.159.885.159 1.372v3.292zm-6.4-.154v-3.138c0-.577.062-1.073.187-1.487a3.65 3.65 0 01.476-1.034c.193-.276.406-.49.64-.64.235-.151.464-.25.689-.294.423.372.742.823.957 1.352.215.53.323 1.102.323 1.718 0 .417-.098.804-.294 1.16a4.006 4.006 0 01-.76.977 6.01 6.01 0 01-1.054.794c-.392.234-.78.432-1.165.592z',
    },
    {
      id: 29,
      name: 'kn',
      displayName: 'ಕನ್ನಡ',
      iconPath:
        'M15.917 21.446a6.28 6.28 0 001.52-.172c.462-.115.86-.286 1.194-.513.334-.227.594-.509.78-.846.186-.337.278-.727.278-1.172a2.196 2.196 0 00-1.2-1.897h1.42v-1.245h-3.208v-.937h.996c.46 0 .852-.06 1.18-.18.326-.12.595-.278.805-.476.21-.197.365-.427.465-.688.1-.261.15-.534.15-.817 0-.298-.088-.617-.263-.96-.176-.341-.44-.685-.791-1.032l-.938.9a2.221 2.221 0 01.344.462c.05.088.09.179.121.271a.838.838 0 01-.245.919c-.196.174-.474.26-.835.26h-5.779v1.34h3.223v.938h-3.223v1.245h1.42a2.166 2.166 0 00-.966.971c-.088.178-.149.35-.183.516a2.128 2.128 0 00-.051.41c0 .445.093.835.278 1.172.186.337.446.62.78.846.335.227.734.398 1.198.513.463.115.974.172 1.53.172zm-.006-1.348c-.371 0-.695-.047-.97-.142a2.11 2.11 0 01-.689-.378 1.585 1.585 0 01-.414-.53 1.424 1.424 0 01-.139-.612 1.4 1.4 0 01.158-.674c.105-.195.253-.361.446-.498s.426-.24.7-.311c.273-.071.578-.107.915-.107.332 0 .634.036.905.107.27.07.503.174.696.31.193.138.341.304.446.499a1.4 1.4 0 01.158.674c0 .21-.046.414-.14.611-.092.198-.23.375-.413.531a2.11 2.11 0 01-.689.378 2.978 2.978 0 01-.97.142z',
    },
    {
      id: 30,
      name: 'pu',
      displayName: 'ਪੰਜਾਬੀ',
      iconPath:
        'M18.056 22.888v-7.904h1.36v-1.648h-3.488v5.936a2.531 2.531 0 01-.776.408c-.283.09-.6.136-.952.136-.405 0-.77-.064-1.096-.192-.325-.128-.568-.315-.728-.56.224-.395.397-.808.52-1.24.123-.432.184-.883.184-1.352 0-.363-.03-.71-.088-1.04a7.242 7.242 0 00-.216-.904 6.657 6.657 0 00-.496-1.192H9v1.648h1.84c.032.17.059.363.08.576.021.213.032.47.032.768 0 .48-.07.965-.208 1.456-.139.49-.352.97-.64 1.44.437.8.997 1.379 1.68 1.736.683.357 1.456.536 2.32.536a4.74 4.74 0 001.056-.104c.299-.07.555-.163.768-.28v1.776h2.128zm4.208 0v-7.904h1.36v-1.648h-1.36v-1.472c0-.48-.088-.901-.264-1.264a2.55 2.55 0 00-.704-.896 3.024 3.024 0 00-1.016-.528A4.042 4.042 0 0019.096 9c-.47 0-.899.064-1.288.192-.39.128-.723.317-1 .568-.277.25-.496.565-.656.944-.16.379-.24.813-.24 1.304v.464h2.128v-.608c0-.363.096-.643.288-.84.192-.197.448-.296.768-.296.31 0 .557.099.744.296.187.197.28.477.28.84v1.472h-1.344v1.648h1.36v7.904h2.128z',
    },
  ];

  return (
    <View style={styles.mainContainer}>
      <LinearGradient colors={[colors.white, colors.PaleBlue]} style={{flex: 1}}>
        <SafeAreaView />
        <Header
          screenName={changeLanguage.changeLanguage}
          menu={true}
          leftIconPress={props.navigation.toggleDrawer}
        />
        <View style={{flex: 1}}>
          <View style={styles.outerView}>
            <View style={styles.imageContainer}>
              <Image
                source={language}
                style={{height: heightScale(32), width: widthScale(32)}}
                resizeMode='contain'
              />
            </View>
            <View style={{marginLeft: widthScale(8)}}>
              <Text style={styles.prefferedLanguage}>
                {changeLanguage.prefferedLanguage}
              </Text>
            </View>
          </View>
          <FlatList
            data={data}
            showsVerticalScrollIndicator={false}
            renderItem={({item}) => {
              return (
                <TouchableOpacity
                  style={styles.langaugeView}
                  onPress={() => { setSelectedLanguage(item.name); }}
                  activeOpacity={0.8}
                >
                  <View style={{flexDirection: 'row', alignItems: 'center'}}>
                    <LanguagesSymbol
                      lan={item.name}
                      iconPath={item.iconPath}
                    />
                    <Text style={styles.nameText}>
                      {item.displayName}
                    </Text>
                  </View>
                  {(item.name === selectedLanguage) && (
                    <Image
                      source={checkMark}
                      style={{height: heightScale(24), width: widthScale(24)}}
                      resizeMode='contain'
                    />
                  )}
                </TouchableOpacity>
              );
            }}
          />
          <View style={styles.buttonContainer}>
            <CustomButton
              onPress={() => { setLanguageTag(selectedLanguage); }}
              title={changeLanguage.updateLanguage}
              containerStyles={{flex: 0}}
              leftIconContainerStyles={{flex: 0}}
              rightIconContainerStyles={{flex: 0}}
            />
          </View>
        </View>
      </LinearGradient>
    </View>
  );
};

const styles = StyleSheet.create({
  mainContainer: {
    flex: 1,
    backgroundColor: colors.white,
  },
  prefferedLanguage: {
    fontSize: normalize(16),
    color: colors.DarkGray,
    fontFamily: fonts.calibri.semiBold,
    textAlignVertical: 'center',
    includeFontPadding: false,
  },
  langaugeView: {
    marginHorizontal: widthScale(16),
    marginVertical: heightScale(10),
    borderRadius: moderateScale(12),
    paddingHorizontal: widthScale(16),
    paddingVertical: heightScale(8),
    elevation: normalize(5),
    backgroundColor: colors.white,
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
  },
  nameText: {
    marginLeft: widthScale(16),
    fontSize: normalize(16),
    color: colors.DarkGray,
    fontFamily: fonts.calibri.regular,
  },
  outerView: {
    paddingVertical: heightScale(16),
    paddingHorizontal: widthScale(16),
    flexDirection: 'row',
    alignItems: 'center',
  },
  imageContainer: {
    height: heightScale(36),
    width: widthScale(36),
    alignItems: 'center',
    justifyContent: 'center',
  },
  buttonContainer: {
    paddingVertical: heightScale(16),
    paddingHorizontal: widthScale(16),
  },
});

const mapStateToProps = ({App}) => {
  const {
    getAllowedLanguagesSuccess,
  } = App;

  return {
    getAllowedLanguagesSuccess,
  };
};

const mapDispatchToProps = {};

export default connect(mapStateToProps, mapDispatchToProps)(ChangeLanguage);
